

<div>
  <h3> informações do notebook</h3>
    <ul>
      <li> Identificador: <%= @equipment.identifier%></li>
      <li> Marca: <%= @equipment.brand %></li>
      <li> Modelo: <%= @equipment.model %></li>
      <li> Nº Patrimônio: <%= @equipment.patrimony_number %></li>
      <li> Nº Serie: <%= @equipment.serial_number %></li>
      <li> Data de Compra: <%= @equipment.purchase_date.strftime("%d/%m/%Y") %></td>
      <li> Data de Fabricação: <%= @equipment.manufacture_date.strftime("%d/%m/%Y") %></td>
      <li> Descrição: <%= @equipment.description %></li>
      <li> Status: <%= @equipment.status_before_type_cast %></li> <%#assim ele exibe o valor no banco, não da chave%>
    </ul>
      <%= link_to "Editar Notebook", edit_equipment_path(@equipment) %>
      <%= button_to "Deletar Notebook", equipment_path(@equipment), method: :delete, data: { confirm: "Tem certeza que deseja excluir este notebook?" } %>
</div>



<h3 align="center">Histórico de Empréstimos</h3>
<div align="center">
  <%= search_form_for @q, url: equipment_path(@equipment) do |emp| %>

    <div>
      <%= emp.label :loan_action_eq, "Ação" %>
      <%= emp.select :loan_action_eq, Loan.loan_actions.map { |k, v| [k.titleize, v] }, include_blank: "Todos" %>
    </div>
    <div>
      <%= emp.label :collaborator_name_cont, "Colaborador" %>
      <%= emp.search_field :collaborator_name_cont %>
    </div>
    <div>
      <%= emp.label :created_at_lteq, "Antes de" %>
      <%= emp.date_field :created_at_lteq %>
    </div>
    <div>
      <%= emp.label :created_at_gteq, "Depois de" %>
      <%= emp.date_field :created_at_gteq %>
    </div>
    <div>
      <%= emp.label :created_at_eq, "No dia" %>
      <%= emp.date_field :created_at_eq %>
    </div>
    <div>
      <%= emp.submit "Filtrar" %>
      <%= link_to "Limpar", equipment_path(@equipment) %>
    </div>

  <% end %>
</div>

<div align="center">
  <% if @filtered_loans.any? %>
    <table border="1px" align="center">
      <thead>
        <tr>
          <th>Ação</th>
          <th>Data</th>
          <th>Colaborador</th>
          <th>Motivo</th>
        </tr>
      </thead>
      <tbody>
        <% @filtered_loans.order(created_at: :desc).each do |loan| %>
          <tr>
            <td><%= loan.loan_action.titleize %></td>
            <td>
              <%=
                case loan.loan_action
                when "emprestimo" then loan.loan_date
                when "devolucao"  then loan.return_date
                when "baixa"      then loan.discard_date
                end
              %>
            </td>
            <td><%= loan.collaborator.name %></td>
            <td>
              <%=
                case loan.loan_action
                when "devolucao"  then loan.return_reason
                when "baixa"      then loan.discard_reason
                else "-"
                end
              %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p>Este notebook ainda não tem histórico de empréstimos.</p>
  <% end %>
</div>